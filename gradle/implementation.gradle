ext {
    startup_group = 'com.github.evilmouth.startup'
    startup_version = 'main-SNAPSHOT'

    useMaven = true
    useLocalMaven = false

    startupCore = this.&startupCore
    startupCorePlugin = this.&startupCorePlugin

    isCI = this.&isCI()
}

def startupCore() {
    if (isCI) {
        return project(':core')
    } else if (useLocalMaven) {
        return 'net.evilmouth:core:1.0.0-SNAPSHOT'
    } else if (useMaven) {
        return "$startup_group:core:$startup_version"
    } else {
        return project(':core')
    }
}

def startupCorePlugin() {
    if (isCI) {
        throw IllegalAccessException()
    } else if (useLocalMaven) {
        return 'net.evilmouth:core-plugin:1.0.0-SNAPSHOT'
    } else if (useMaven) {
        return "$startup_group:core-plugin:$startup_version"
    } else {
        return 'net.evilmouth:core-plugin:1.0.0-SNAPSHOT'
    }
}

static boolean isCI() {
    def map = System.getenv()
    if (map == null) {
        return false
    }
    def isGithubCI = map.containsKey("CI") && map.get("CI") == "true"
    def isJitpackCI = map.containsKey("JITPACK") && map.get("JITPACK") == "true"
    return isGithubCI || isJitpackCI
}